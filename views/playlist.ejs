<%- include('./partial/header.ejs'); %>


    <div class="center">
        <p id="resultMessage" class="fs-1 text-secondary">Your playlists</p>
    </div>


    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Create Playlist</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="mb-3">
                            <label for="playlist" class="col-form-label">Playlist Name:</label>
                            <input type="text" class="form-control" id="name" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" onclick="createPlaylist()">Create</button>
                </div>
            </div>
        </div>
    </div>



    <br/><br/><br/>
    <div class="container">
        <div class="row">
            <div class="col-sm-8 center">
                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal"> <span style="vertical-align: bottom;" class="material-icons">
                    add
                    </span> Create New Playlist</button>
                <br/><br/>



                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th scope="col">#</th>
                            <th scope="col">Name</th>

                        </tr>
                    </thead>
                    <tbody>

                        <% for(var i = 0; i<data.allPlaylist.length; i++)  {%>

                            <tr>
                                <th scope="row">
                                    <%= i+1 %>
                                </th>
                                <td>
                                    <a href="" class="noUnderline fs-4">
                                        <%= data.allPlaylist[i].name %>
                                    </a>
                                </td>
                            </tr>
                            <% } %>


                    </tbody>
                </table>






            </div>
        </div>
    </div>

    <br/><br/><br/>



    <script>
        async function createPlaylist() {
            var model = document.getElementById('exampleModal')
            resultMessage = document.getElementById("resultMessage");
            var name = document.getElementById("name").value;

            $('#exampleModal').modal('hide');


            var data = {
                name,
            }

            options = {
                method: 'POST',
                headers: {
                    'Accept': 'application/json, text/plain, */ *',
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            }

            let res = '';
            try {
                res = await fetch('/playlist/createNewPlaylist', options);
                res = await res.json();
                resultMessage.innerHTML = res.msg;
                console.log(res);
            } catch (ex) {
                console.log(ex);
                resultMessage.innerHTML = ex;
            }
            location.assign('/playlist');


        }
    </script>


    <%- include('./partial/footer.ejs'); %>